(function () {
  'use strict';

  angular
    .module('<%= moduleName %>')
    .component('<%= widgetComponentName %>', {
      templateUrl: ':::PLUGIN_PATH:::/widget.html',
      bindings: {
        device: '<'
      },
      controller: Controller,
      controllerAs: 'vm'
    });

  /* @ngInject */
  function Controller(<%= widgetDataServiceName %>) {
    const vm = this;

    _.assign(vm, {
      $onInit: onInit,
      $onChanges: onChanges
    });

    ////////////

    function onInit() {

    }

    function onChanges(changes) {
      if (changes.device) {
        onDeviceChange();
      }
    }

    function onDeviceChange() {
      const { device } = vm;

      if (device) {
        <%= widgetDataServiceName %>.getDataForDeviceId(device.id)
          .then(data => (vm.data = data))
          .then(onDataChange);
      }
    }

    function onDataChange() {

    }
  }
}());
